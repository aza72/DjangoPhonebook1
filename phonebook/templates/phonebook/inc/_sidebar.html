{#-Левый боковой навбар-#}

<!--{# загружаем пользовательский тег #}-->
{% load phonebook_tags %}
{% get_division as divisions %}
{% load mptt_tags %}

<!--{#<nav class="nav flex-column">#}-->
<!--{##}-->
<!--{#  <a class="nav-link disabled" tabindex="-1" aria-disabled="true">Наименование:</a>#}-->
<!--{##}-->
<!--{#   &lt;!&ndash;запускаем пользовательский тег show_divisions, каторый данные загружает уже со страницы 'phonebook/list_divisions.html'&ndash;&gt;#}-->
<!--{##}-->
<!--{##}-->
<!--{#- Перечисление всех подразделений, список divisions - сформирован пользовательским тегом show_divisions() в phonebook_tags.py -#}-->
<!--{#{% for di in divisions %}#}-->
<!--{#    {% if di.pk == div_selected %}#}-->
<!--{##}-->
<!--{#    &lt;!&ndash;  отображение списка подразделений через прямого обращение к номеру записи в базе данных &ndash;&gt;#}-->
<!--{#    &lt;!&ndash;  ссылка формируется через метод get_absolute_url описанного в классе Division файла models.py&ndash;&gt;#}-->
<!--{#    <a  class="list-group-item list-group-item-action" >#}-->
<!--{#      &lt;!&ndash;   di.title - обращение к имени подразделения, di.cnt - подсчет записи в этом подразделении&ndash;&gt;#}-->
<!--{#    {{ di.title }}#}-->
<!--{#    </a>#}-->
<!--{#   {% else %}#}-->
<!--{#        <a href="{{ di.get_absolute_url }}" class="list-group-item list-group-item-action" name="orderby" >#}-->
<!--{#      &lt;!&ndash;   di.title - обращение к имени подразделения, di.cnt - подсчет записи в этом подразделении&ndash;&gt;#}-->
<!--{#    {{ di.title }}#}-->
<!--{#    </a>#}-->
<!--{#    {% endif %}#}-->
<!--{##}-->
<!--{#{% endfor %}#}-->
<!--{#</nav>#}-->

<!--{% recursetree divisions %}-->
<!--    <div class="accordion" id="accordionExample">-->
<!--    <div class="accordion-item">-->
<!--      <h2 class="accordion-header" id="headingOne">-->
<!--        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ node.id }}" aria-expanded="true" aria-controls="collapse{{ node.id }}">-->
<!--          {{ node.title }}-->
<!--        </button>-->

<!--      </h2>-->
<!--      {% if not node.is_leaf_node %}-->
<!--        <div id="collapse{{ node.id }}" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">-->
<!--          <div class="accordion-body">-->
<!--            {% for child in node.get_children %}-->
<!--                {% if child.pk == div_selected %}-->
<!--                    {{ child.title }}<br>-->
<!--                {% else %}-->
<!--                <a href="{{ child.get_absolute_url }}">{{ child.title }}</a><br>-->
<!--                {% endif %}-->
<!--            {% endfor %}-->
<!--          </div>-->
<!--        </div>-->
<!--      {% endif %}-->
<!--    </div>-->
<!--  </div>-->
<!--{% endrecursetree %}-->

{#<div class="menu" id="menuul" >#}
{#{% for division,structure in divisions|tree_info %}#}
{#    {% if structure.new_level %}<ul><li>{% else %}</li><li>{% endif %}#}
{#        {{ division.title }}#}
{#    {% for level in structure.closed_levels %}</li></ul>{% endfor %}#}
{#{% endfor %}#}
{#</div>#}
<div class="menu" id="menuul" >
<!--<div  id="s" >{{div_selected}}</div>-->
<ul>
    {% recursetree divisions %}
<!--<button type="button">+</button>-->
        <li>
            {% if node.id == div_selected %}
            {{ node.title }}

            {% else %}
           <span> <a href="{{ node.get_absolute_url }}" >{{ node.title }}</a></span>
            {% endif %}
         <hr class="dropdown-divider">
            {% if not node.is_leaf_node %}
                {% if node.id == div_selected %}
                <ul class="children"  >
                    {{ children }}

                </ul>
             {% else %}
                <ul class="children"  >
                   <a href="{{ children.get_absolute_url }}" > {{ children }}</a>
                </ul>
            {% endif %}
            {% endif %}
        </li>

    {% endrecursetree %}
</ul>
</div>

<script>
    let menu = document.querySelector("#menuul");
    menu.onclick = function (event) {
        let t = event.target.childNodes;
        // if (t.tagName == 'LI') return;
        // let c = t.document.querySelector("ul");
        // t["ul.children"].toggle('children');
        // let child = Array.from(t);
        // child[1].classList.toggle('children');
        // let position = child.tagName.indexOf("ul.children");

        alert(t.indexOf("ul"));

for (let i = 0; i < t.length; i++) {
    if (t.item(i) == "ul"){
        console.log("123");
    }
        // alert(t.item(i));
        // console.log(t.item(i));

}
    // b = t.item(1);
    // b.classList.toggle('children');
        // alert(t[3]);
        // console.log(t.tagName);
        // b.classList.toggle('children');
    }



//     for (let li of menu.querySelectorAll("li")){
//         for (let b of li.querySelectorAll("a")){
//             // b.classList.toggle('children');
//
//             if (b == null) {
//
//                 c = b.parentNode.querySelector("ul");
//                 c.classList.toggle('children');
//             }
//         }
//         let span = document.createElement('span');
//         {#span.classList.add('list');#}
//         span.classList.add('show');
//         li.prepend(span);
//         span.append(span.nextSibling);
//
//     }
// menu.onclick = function (event) {
//      console.log(event.target.tagName);
//      if (event.target.tagName != 'SPAN') return;
//      let childcont = event.target.parentNode.querySelector("ul");
//      // alert(childcont.length);
//      if (!childcont) return;
//      // childcont.hidden = !childcont.hidden;
//      childcont.classList.toggle('children');
// }
</script>