{#-Левый боковой навбар-#}

<!--{# загружаем пользовательский тег #}-->
{% load phonebook_tags %}
{% get_division as divisions %}
{% load mptt_tags %}


<div class="menu" id="menuul" >

    <ul>
        {% recursetree divisions %}
            <li>
            {% if node.is_root_node == True %}
                <span class="parent">  <a href="{{ node.get_absolute_url }}">{{ node.title }}</a>
           <hr class="dropdown-divider">
            {% else %}
                <a href="{{ node.get_absolute_url }}">{{ node.title }}</a>
            <hr class="dropdown-divider">
            {% endif %}

                {% if not node.is_leaf_node %}
                    <ul class="children">
                        {{ children }}
                    </ul>
                {% endif %}
            {% if node.is_root_node == True %}
                </span>
            {% endif %}
            </li>

        {% endrecursetree %}
    </ul>
</div>

<script>
let menu = document.querySelector("#menuul");   //Получаем меню по id
let currentUrl = window.location.href;          //Получаем текущий url страницы
let linksOfMenu = menu.querySelectorAll(" a "); //Получаем все ссылки в меню

for (let link of linksOfMenu){ //Проходим по всем ссылкам меню

    if (link.href == currentUrl){ //Выполняем условие если ссылка меню соответствует текущему url
        let parNode = link.closest(".parent");   //Получаем родителя по селектору
        let linksChildren = parNode.querySelectorAll("a");  //Получаем  ссылки родителя и дочерних элементов
        for (let link of linksChildren){   //Проходим по ссылкам категории меню и его дочерним элементам
            let elemUl = link.parentNode.querySelector("ul");   //Получаем категорию меню
                    if (elemUl == null) { //Если категория меню последняя
                        break;   //завершаем цикл
                    }
                    else if (link.href == currentUrl){   //если урл текущего пункта меню равен текущему урл страницы
                        elemUl.classList.remove("children"); //Удаляем скрываюший класс у элемента
                        break; //завершаем цикл
                    }
                    else{
                        elemUl.classList.remove("children"); //удаляем скрывающий класс у текущего элемента
                    }

        }
        let deleteLink = link.parentNode.querySelector("a");//Получаем ссылку соответствующую урл текущей страницы
        deleteLink.removeAttribute("href"); //Удаляем активность ссылки

    }

}
</script>